"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};$(document).ready(function(){var e=window.$;window.HDIUI=window.HDIUI||{};var o;window.HDIFileBrowser&&(o=new HDIFileBrowser({id:"hdi-filebrowser",skipFetch:!0}),o.$el.appendTo("body"),window.HDIUI.filebrowser=o),window.HDIUI.downloadURL=function(o,r,i,l){var a,t,d,n,s,w,f={}.hasOwnProperty;if(o||urlParameters.hasOwnProperty("print")&&(o=urlParameters.print),o&&/^(pdf|jpg|png|xls)/i.test(o)===!1||""===o||void 0===o)return e.notify({message:"Print format cannot be empty or unknown",icon:"fa fa-exclamation-triangle"},{type:"danger"}),!1;a={format:o},a.xml="",d={},w=Dashboard.getAllVariables();for(t in w)f.call(w,t)&&(s=w[t],""===s||"object"===("undefined"==typeof s?"undefined":_typeof(s))&&0===s.length||(d[t]=s));delete d.print,urlParameters.hasOwnProperty("print")&&(a.print=!0),n=window.DashboardGlobals.file.split(".")[1],void 0!==_typeof(window.DashboardGlobals.optionalReportParams.reportname)&&(a.dir=window.DashboardGlobals.folderpath,a.filename=window.DashboardGlobals.file,a.reportType=n,a.reportNameParam=window.DashboardGlobals.fileTitle,a.reportFile=window.DashboardGlobals.file,a.resultDirectory=i||window.DashboardGlobals.optionalReportParams.location,a.reportName=r||window.DashboardGlobals.optionalReportParams.reportname,d.mode="efwsr"===n?"open":"",a.reportParameters=d?JSON.stringify(d):""),(!l&&"true"===window.DashboardGlobals.enableReportSave||"false"===window.DashboardGlobals.enableReportSave)&&e.download(window.DashboardGlobals.reportDownload,a)},e("[data-saveurl]").on("click",function(o){var r,i;return o.preventDefault(),r=e(this),r.hasClass("disabled")||r.closest("li").hasClass("disabled")?!1:(i=r.data("format"))?void("true"===window.DashboardGlobals.enableReportSave?(window.HDIUI.filebrowser.fetchData().done(function(){return window.HDIUI.filebrowser.show({title:"Download Report",footer:'<div class="form" id="hideDownloadReportTemp"> <div class="form-group has-error hidden"  id="error-folder"> <br> <span class="error-msg">Please select a location</span> </div> <br> <div class="form-group"> <label class="control-label" for="download-report-name">Download Report Name</label> <input type="text" class="form-control" maxlength="60" id="download-report-name" name="download-report-name" data-validation-rules="required|filename|length(3)" data-validation-on="focusout" data-validation-msg="Please enter valid report name, minimum length 3."> </div> <div class="form-group text-right"> <button class="btn btn-primary" id="download-report" data-validate="#download-report-name" data-validate-on="click">Download Report</button> <button class="btn btn-danger" id="hide-file-explorer" data-dismiss="modal">Cancel</button> </div> </div>',hideFiles:!0,hideProperties:!0,hideFilters:!0,hideContext:!1,hideNonWritable:!0})}),window.HDIUI.filebrowser.selectedPath=null,window.HDIUI.filebrowser.updateBreadCrumb(""),window.HDIUI.filebrowser.$("#hdi-file-properties").html(""),window.HDIUI.filebrowser.$("#error-folder").addClass("hidden"),window.HDIUI.filebrowser.$el.off("click.saveAs","hdi-file-filter","#hideSaveReport").on("click.saveAs","hdi-file-filter","#hideSaveReport",function(e){return window.HDIUI.filebrowser.hide(),window.HDIUI.filebrowser.filetree.collapseAll(),window.HDIUI.filebrowser.clearFileBrowser()}),window.HDIUI.filebrowser.$el.off("click.hideFileExp","hdi-file-filter","#hide-file-explorer").on("click.hideFileExp","hdi-file-filter","#hide-file-explorer",function(e){return window.HDIUI.filebrowser.hide(),window.HDIUI.filebrowser.filetree.collapseAll(),window.HDIUI.filebrowser.clearFileBrowser()}),window.HDIUI.filebrowser.$el.off("click.saveAs","#download-report").on("click.saveAs","#download-report",function(o){var r,l;return window.HDIUI.filebrowser.$("#error-folder").addClass("hidden"),(l=window.HDIUI.filebrowser.getSelected())?e("#download-report-name").validate()?(r=window.HDIUI.filebrowser.$("#download-report-name").val(),window.HDIUI.filebrowser.hide(),window.HDIUI.downloadURL(i,r,l.actual),window.HDIUI.filebrowser.fetchData()):!1:(window.HDIUI.filebrowser.$("#error-folder").removeClass("hidden"),!1)})):window.HDIUI.downloadURL(i)):!1}),window.HDIUI.showExport=function(){window.HDIUI.filebrowser.fetchData().done(function(){return window.HDIUI.filebrowser.show({title:"Download Report",footer:'<div class="form" id="hideDownloadReportTemp"> <div class="form-group has-error hidden"  id="error-folder"> <br> <span class="error-msg">Please select a location</span> </div> <br> <div class="form-group"> <label class="control-label" for="download-report-name">Download Report Name</label> <input type="text" class="form-control" maxlength="60" id="download-report-name" name="download-report-name" data-validation-rules="required|filename|length(3)" data-validation-on="focusout" data-validation-msg="Please enter valid report name, minimum length 3."> </div> <div class="form-group text-right"> <button class="btn btn-primary" id="download-report" data-validate="#download-report-name" data-validate-on="click">Download Report</button> <button class="btn btn-danger" id="hide-file-explorer" data-dismiss="modal">Cancel</button> </div> </div>',hideFiles:!0,hideProperties:!0,hideFilters:!0,hideContext:!1,hideNonWritable:!0})}),window.HDIUI.filebrowser.selectedPath=null,window.HDIUI.filebrowser.updateBreadCrumb(""),window.HDIUI.filebrowser.$("#hdi-file-properties").html(""),window.HDIUI.filebrowser.$("#error-folder").addClass("hidden"),window.HDIUI.filebrowser.$el.off("click.saveAs","hdi-file-filter","#hideSaveReport").on("click.saveAs","hdi-file-filter","#hideSaveReport",function(e){return window.HDIUI.filebrowser.hide(),window.HDIUI.filebrowser.filetree.collapseAll(),window.HDIUI.filebrowser.clearFileBrowser()}),window.HDIUI.filebrowser.$el.off("click.hideFileExp","hdi-file-filter","#hide-file-explorer").on("click.hideFileExp","hdi-file-filter","#hide-file-explorer",function(e){return window.HDIUI.filebrowser.hide(),window.HDIUI.filebrowser.filetree.collapseAll(),window.HDIUI.filebrowser.clearFileBrowser()})};var r={}.hasOwnProperty;e("body").on("report.opened.hdi",function(){e(".disabled[data-saveurl]").removeClass("disabled"),e(".disabled > [data-saveurl]").closest(".disabled").removeClass("disabled")}),e.download=function(o,i){var l,a,t,d,n=arguments.length<=2||void 0===arguments[2]?"post":arguments[2],s=function(e,o,r){return document.cookie=e+"="+o+"; Path=/"+r};if(i&&o){var w=window.location.pathname.substring(1).split("/")[0],f=(s("hi_report_downloadStatus",0,w),function(){for(var e=document.cookie.split(";"),o={},r=0,i=e.length;i>r;r++){var l=e[r].split("=");2===l.length&&(o[l[0].trim()]=l[1].trim())}return o}),p=!1,c=setInterval(function(){var o=f();"0"!==o.hi_report_downloadStatus||p||(bootbox.dialog({message:"Please wait while downloading",closeButton:!1,title:'Downloading<i class="fa fa-repeat spin pull-right"></i>',buttons:{danger:{label:"Close",className:"btn-danger hi-cancelDownload",callback:function(){e(".hi-cancelDownload").on("click",function(){return!1})}}}}),p=!0),"1"===o.hi_report_downloadStatus&&(clearInterval(c),bootbox.hideAll(),o.hi_report_downloadStatus="0")},100);l=e(document.createElement("form")).attr("method",n).attr("action",o);for(t in i)r.call(i,t)&&(d=i[t],a=e(document.createElement("input")).attr("name",t).attr("value",d).attr("type","hidden"),l.append(a));l.appendTo("body").submit().remove()}}});
//# sourceMappingURL=downloadURL.js.map
